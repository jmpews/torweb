!function(){var a="/custor/uploadimg";tinymce.create("tinymce.plugins.PasteUploadPlugin",{init:function(e,t){function n(a){var e,t;for(e=0;e<a.clipboardData.items.length;){if(t=a.clipboardData.items[e],t.type.indexOf("image")!==-1)return t;e++}return!1}function i(e,t){var n=new FormData;n.append("imageFile",e),n.append("mimeType",e.type),$.ajax({url:a,data:n,type:"post",processData:!1,contentType:!1,dataType:"json",success:function(a){0==a.errorcode&&r(a.data.image)},error:function(a,e){console.log(a.responseText)}})}function r(a){e.getContent();e.insertContent('<img src="/static/images/'+a+'">'),e.selection.select(e.getBody(),!0),e.selection.collapse(!1)}function o(a){var e;return window.clipboardData&&window.clipboardData.getData?e=window.clipboardData.getData("Text"):a.clipboardData&&a.clipboardData.getData&&(e=a.clipboardData.getData("text/plain")),e=e.split("\r"),e[0]}e.on("Paste",function(a){var e,t;if(t=a,t.clipboardData&&t.clipboardData.items&&(e=n(t)))return a.preventDefault(),i(e.getAsFile(),o(t))}),e.on("Drop",function(a){var e,t,n;if(n=a,n.dataTransfer&&n.dataTransfer.files&&(t=isImageForDrop(n)))return e=n.dataTransfer.files[0].name||"image.png",a.preventDefault(),i(t,e)}),isImageForDrop=function(a){var e,t;for(e=0;e<a.dataTransfer.files.length;){if(t=a.dataTransfer.files[e],t.type.indexOf("image")!==-1)return t;e++}return!1}}}),tinymce.PluginManager.add("pasteUpload",tinymce.plugins.PasteUploadPlugin)}();